---
tags: [vim]
date: 2019-01-10 05:59:55
---

执行下面的命令：

```vim
:normal G
```

Vim将把你的光标移到当前文件的最后一行，就像是在normal模式里按下`G`。现在执行下面命令：

```vim
:normal ggdd
```

Vim将移动到文件的第一行(`gg`)并删除它(`dd`)。

`normal`命令简单地接受一串键值并当作是在normal模式下输入的。就是那么简单！

## 避免映射

执行下面的命令来映射`G`键到别的东西：

```vim
:nnoremap G dd
```

现在在normal模式按下`G`将删除一整行。试试这个命令：

```vim
:normal G
```

Vim将删除当前行。`normal`命令将顾及当前的所有映射。

这意味着我们需要给`normal`提供类似于`nnoremap`之于`nmap`的版本， 否则我们没法使用它——考虑到我们猜测不了用户的映射方式。

幸好Vim真的有这样的命令叫`normal!`。执行这个命令：

```vim
:normal! G
```

这次Vim将移动光标到文件底部，即使`G`已经被映射了。

在写Vim脚本时，你应该*总是*使用`normal!`，*永不*使用`normal`。不要信任用户在`~/.vimrc`中的映射。

## 特殊字符

如果你使用`normal!`一段时间了，就很可能注意到一个问题。试试下面的命令：

```vim
:normal! /foo<cr>
```

第一眼看上去它应该会开始搜索`foo`，但你将看到它不会正常工作。 问题在于`normal!`不会解析像`<cr>`那样的特殊字符序列。
